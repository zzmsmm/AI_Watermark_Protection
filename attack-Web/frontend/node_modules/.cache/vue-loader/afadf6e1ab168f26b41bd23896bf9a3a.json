{"remainingRequest":"E:\\code\\iot-anomaly-web-master\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\code\\iot-anomaly-web-master\\src\\views\\centralization_FL\\index.vue?vue&type=style&index=0&id=23a0798f&scoped=true&lang=css&","dependencies":[{"path":"E:\\code\\iot-anomaly-web-master\\src\\views\\centralization_FL\\index.vue","mtime":1630065466000},{"path":"E:\\code\\iot-anomaly-web-master\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\code\\iot-anomaly-web-master\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"E:\\code\\iot-anomaly-web-master\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"E:\\code\\iot-anomaly-web-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\code\\iot-anomaly-web-master\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCi5tZW51IHsKICBtYXJnaW4tdG9wOiAxMnB4OwogIGRpc3BsYXk6IGZsZXg7CiAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOwogIGFsaWduLWl0ZW1zOiBjZW50ZXIKfQoK"},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8gBA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/centralization_FL","sourcesContent":["<template>\n\n  <el-container style=\"height: 100vh;padding:1% 3% 0 3%\">\n    <el-aside style=\"padding: 20px 30px 0 0\">\n      <h3>配置边缘节点</h3>\n\n      <div class=\"menu\">\n        边缘节点数量\n        <el-input-number\n          v-model=\"clientNum\"\n          controls-position=\"right\"\n          :min=\"1\"\n          :max=\"20\"\n          size=\"mini\"\n          @change=\"setprocess(0)\"\n          :disabled=\"isTraining\"\n        ></el-input-number>\n      </div>\n\n      <div class=\"menu\">\n        数据集\n        <el-select v-model=\"datasetvalue\"\n                   placeholder=\"选择一个数据库\"\n                   size=\"mini\"\n                   @change=\"setprocess(0)\"\n                   :disabled=\"isTraining\">\n          <el-option\n            v-for=\"item in datasetoptions\"\n            :key=\"item.value\"\n            :label=\"item.label\"\n            :value=\"item.value\"\n            :disabled=\"item.disabled\">\n          </el-option>\n        </el-select>\n      </div>\n\n      <el-divider></el-divider>\n\n      <h3>发布任务</h3>\n\n      <div class=\"menu\">\n        模型\n        <el-select v-model=\"modelvalue\"\n                   placeholder=\"选择一个模型\"\n                   size=\"mini\"\n                   @change=\"setprocess(1)\"\n                   :disabled=\"isTraining\">\n          <el-option-group\n            v-for=\"group in modeloptions\"\n            :key=\"group.label\"\n            :label=\"group.label\">\n            <el-option\n              v-for=\"item in group.options\"\n              :key=\"item.value\"\n              :label=\"item.label\"\n              :value=\"item.value\"\n              :disabled=\"item.disabled\">\n            </el-option>\n          </el-option-group>\n        </el-select>\n      </div>\n\t  \n\t  <div class=\"menu\">\n\t    策略\n\t    <el-select v-model=\"strategyvalue\"\n\t               placeholder=\"选择一种策略\"\n\t               size=\"mini\"\n\t               @change=\"setprocess(1)\"\n\t               :disabled=\"isTraining\">\n\t      <el-option\n\t        v-for=\"item in strategyoptions\"\n\t        :key=\"item.value\"\n\t        :label=\"item.label\"\n\t        :value=\"item.value\"\n\t        :disabled=\"item.disabled\">\n\t      </el-option>\n\t    </el-select>\n\t  </div>\n\n      <div class=\"menu\">\n        <span>训练轮数</span>\n        <el-input-number v-model=\"traintime\"\n                         :min=\"0\"\n                         :max=\"100\"\n                         :step=\"1\"\n                         size=\"mini\"\n                         @focus=\"setprocess(1)\"\n                         :disabled=\"isTraining\">\n        </el-input-number>\n      </div>\n\n\n      <el-divider></el-divider>\n\n      <h3>训练进度</h3>\n\n      <div style=\"text-align: center;margin-top: 10px\">\n        <el-progress :percentage=\"currentpercentage\" :status=\"currentstatus\"></el-progress>\n      </div>\n\n      <div style=\"text-align: center;margin-top: 12px\">\n        <el-button type=\"success\"\n                   v-text=\"btnMsg\"\n                   @click=\"startTrain()\"\n                   size=\"mini\"\n                   :disabled=\"isTraining\">\n        </el-button>\n\t\t<el-button type=\"danger\"\n\t\t           v-text=\"btnMsg2\"\n\t\t           @click=\"stop()\"\n\t\t           size=\"mini\">\n\t\t</el-button>\n        \n        <div style=\"text-align: center;margin-top: 12px\">\n         <a href=\"http://127.0.0.1:8000/download/\">\n        <el-button type=\"warning\"\n                   v-text=\"download\"\n                   size=\"mini\"\n                   >                   \n        </el-button>\n        </a>\n\t\t<el-button type=\"primary\"\n\t\t           v-text=\"refresh\"\n\t\t           @click=\"getResult()\"\n\t\t           size=\"mini\"\n\t\t           >\n\t\t</el-button>\n        </div>\n        \n      </div>\n      \n     \n\n      <el-divider></el-divider>\n\n    </el-aside>\n \n    <el-container style=\"padding: 20px 50px\">\n      <el-header height=\"130px\">\n        <h3>进度</h3>\n        <div>\n          <el-steps :active=activestep finish-status=\"success\" align-center>\n            <el-step title=\"配置边缘节点\"></el-step>\n            <el-step title=\"发布任务\"></el-step>\n            <el-step title=\"训练\"></el-step>\n            <el-step title=\"完成\" icon=\"el-icon-finished\"></el-step>\n          </el-steps>\n        </div>\n      </el-header>\n\n      <el-main style=\"border: lightgray dashed 1px;border-radius: 10px;background-color: #f7f8fb\"\n               v-loading=\"this.state==='synchronizing...'\" element-loading-text=\"blockchain synchronizing...\">\n        <div style=\"display: flex;justify-content: flex-start;align-content: flex-start;flex-wrap: wrap\">\n\t\t  <Client v-for=\"(client,index) in clientList\" :key=\"index\" :id=\"index\" :state=\"state[index]\" \n      :readonly=\"isTraining\"  :value=\"value[index]\" :power=\"powers[index]\" :samples=\"clientNum\" \n      :accu=\"accu[index]\" :loss=\"loss[index]\" @change=\"changevalue\"></Client>\n        </div>\n      </el-main>\n\t  \n    </el-container>\n\n  </el-container>\n \n</template>\n\n<script>\nimport {runFL,getRasPi,getResult,getState} from '@/api/user'\n  import Client from \"./components/Client\";\n  //import {run} from '../assets/js/script.js'\n//http://127.0.0.1:8000/downoad/\n  export default {\n    name: \"centralizationfl\",\n\tinject:['reload'],\n    components: {\n      Client\n    },\n    data() {\n      return {\n        flag:true,\n\n        activestep: 0,\n        loss:[\"--\",\"--\",\"--\",\"--\",\"--\",],\n        accu:[\"--\",\"--\",\"--\",\"--\",\"--\",],\n\n        //client\n        clientNum: 2,//客户端数量\n        clientList: [],\n        powers: [5,5,5,5,5],\n        //model\n        modeloptions: [{\n          label: 'Unsupervised Models',\n          options: [{\n            value: 'AutoEncoder',\n            label: 'AutoEncoder'\n          }],\n        }, {\n          label: 'Supervised Models',\n          options: [{\n            value: 'SVM',\n            label: 'SVM',\n            disabled: true\n          }, {\n            value: 'Classification-Decision-Tree',\n            label: 'Classification Decision Tree',\n            disabled: true\n          }],\n        }\n        ],\n        modelvalue: '',\n\n        //dataset\n        datasetoptions: [\n\t\t\t{\n\t\t\t\tvalue: '本地数据',\n\t\t\t\tlabel: '本地数据'\n\t\t\t},\n\t\t\t{\n\t\t\t\tvalue: 'N_BaloT',\n\t\t\t\tlabel: 'N_BaloT'\n\t\t\t},\n\t\t\t{\n\t\t\t\tvalue: 'KDD_Cup99',\n\t\t\t\tlabel: 'KDD_Cup99'\n\t\t\t}\n        ],\n        datasetvalue: '',\n\t\t\n\t\tstrategyoptions: [\n\t\t\t{\n\t\t\t\tvalue: '随机策略',\n\t\t\t\tlabel: '随机策略'\n\t\t\t},\n\t\t\t{\n\t\t\t\tvalue: '不确定度策略',\n\t\t\t\tlabel: '不确定度策略'\n\t\t\t},\n\t\t\t{\n\t\t\t\tvalue: '变量不确定度策略',\n\t\t\t\tlabel: '变量不确定度策略'\n\t\t\t},\n\t\t\t{\n\t\t\t\tvalue: '分割策略​​​​​',\n\t\t\t\tlabel: '分割策略​​​​​'\n\t\t\t}\n\t\t],\n\t\tstrategyvalue: '',\n\n        traintime: 100,\n\n        btnMsg: 'Run',\n\t\tbtnMsg2: 'Stop',\n\n        refresh:'刷新状态',\n\n        download:'下载模型',\n\n        state: ['待选用', '待选用', '待选用', '待选用', '待选用'],\n\n        isTraining: false,\n\n        currentpercentage: 0,\n\n        currentstatus: null,\n\n        result: null,\n\n        updatetime: '',\n\n        blockheight: 1023,\n\t\t\n\t\tvalue: [false, false, false, false, false],\n\t\t\n\t\trun_state: false,\n\t\t\n\t\tk: 1,\n\n    selected:[],\n\n    paramForm:{\n      client:'',//设备数量\n      model:'',//训练模型\n      dataset:'',//数据集\n      traintime:'',//训练轮数\n      selected:[],//选择进行训练的设备号\n      },\n\tparamForm2:{\n\t\tnum: 0,\n\t}\n      }\n      \n\n    },\n    computed: {\n      /*totalpower() {\n        let a = this.$store.state.powerList\n        let sum = 0\n        for (let i = 0; i < a.length; i++) {\n          sum += a[i].power\n        }\n        return sum\n      }*/\n    },\n    created() {\n      this.getDevice()//获取设备信息\n\n      this.initClient()//初始化客户端子组件\n\n      var time = new Date();\n      var y = time.getFullYear();\n      var m = time.getMonth() + 1;\n      var d = time.getDate();\n      var h = time.getHours();\n      var mm = time.getMinutes();\n      var s = time.getSeconds();\n\n      this.updatetime = this.getcurrenttime()\n    },\n    watch: {\n      clientNum: function () {\n        this.initClient()\n      },\n      result: function () {\n      },\n    },\n\t\n    methods: {\n      getDevice()\n      {\n        getRasPi().then(response=>{\n          const { data } = response\n          this.clientNum=data.length\n          this.flag=data.flag\n        })\n\n      },\n      getResult(){\n        getResult().then(response => {\n          const { data } = response\n          console.log(data)\n          if(data.flag)\n          {\n            this.loss=data.loss\n            this.accu=data.accu\n          }\n          \n        }).catch(function(error){\n          console.log(error);\n        })\n      },\n\t\t\n\t\tchangevalue(val1, val2){\n      var index =this.selected.indexOf(val2)\n      console.log(index)\n\n      if(index == -1)\n        this.selected.push(val2)\n      else\n        this.selected.splice(index,1)\n      \n      console.log(this.selected)\n\n\t\t\tthis.value[val2] = val1\n\t\t\tif (val1 === true) {\n\t\t\t\tthis.state[val2] = '已选用'\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.state[val2] = '待选用'\n\t\t\t}\n\t\t},\n      add0(m) {\n        return m < 10 ? '0' + m : m\n      },\n\n      getcurrenttime() {\n        var time = new Date();\n        var y = time.getFullYear();\n        var m = time.getMonth() + 1;\n        var d = time.getDate();\n        var h = time.getHours();\n        var mm = time.getMinutes();\n        var s = time.getSeconds();\n\n        return y + '-' + this.add0(m) + '-' + this.add0(d) + ' ' + this.add0(h) + ':' + this.add0(mm) + ':' + this.add0(s)\n      },\n\n      initClient() {\n        this.clientList = new Array(this.clientNum)\n        //设置初始状态\n\t\t    for(var i = 5;i < this.clientNum;i++){\n\t\t\t    this.state[i] = '待选用';\n\t\t\t    this.value[i] = false;\n          this.powers[i]=5;\n          this.accu[i]=\"--\";\n          this.loss[i]=\"--\";\n\t\t}\n      },\n      setprocess(step) {\n        console.log(\"set\")\n        this.activestep = step\n      },\n\t  \n\t  stop(){\n\t\t  this.reload()\n\t\t  this.run_state = false\n\t  },\n\t  \n      startTrain() {\n            //发送参数给后端运行联邦学习算法\n\t\t\tthis.run_state = true\n            console.log(this.clientNum)\n\t\t\t\tif (this.datasetvalue === '') {\n\t\t\t\t  this.$message.error('Please select a dataset.');\n\t\t\t\t  return\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif (this.modelvalue === '') {\n\t\t\t\t  this.$message.error('Please select a model.');\n\t\t\t\t  return\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif (this.strategyvalue === '') {\n\t\t\t\t  this.$message.error('Please select a strategy.');\n\t\t\t\t  return\n\t\t\t\t}\n        this.paramForm.client=this.clientNum\n        this.paramForm.model=this.modelvalue\n        this.paramForm.traintime=this.traintime\n        this.paramForm.dataset=this.datasetvalue\n        this.paramForm.selected=this.selected\n        this.paramForm.selected.sort()//排序\n        console.log(this.paramForm.selected)\n        runFL(this.paramForm).then(response => {\n        const { data } = response\n       //console.log(data)\n    })\n\n        this.setprocess(2)\n\t\t//this.k = this.k + 1\n\t\tfor (var i = 0;i < this.clientNum;i++){\n\t\t\t//console.log(i)\n\t\t\tif (this.state[i] !== '待选用') {\n\t\t\t\tthis.state[i] = '第'+this.k+'轮训练中...'\n\t\t\t}\n\t\t}\n\t\t\n\t\tlet interval = setInterval(() => {\n\t\t  this.currentpercentage += 1\n\t\t  this.btnMsg = 'Running'\n\t\t  this.isTraining = true\n\t\t  this.currentstatus = null\n\t\t  if (this.run_state ==false) {\n\t\t\t  this.isTraining = false\n\t\t\t  this.btnMsg = 'Run'\n\t\t\t  clearInterval(interval)\n\t\t  }\n\t\t  var flag = false\n\t\t  if (this.currentpercentage === 91) {\t\n\t\t\tthis.paramForm2.num += 1//进度条模拟\n\t\t  \tgetState(this.paramForm2).then(response => {\n\t\t  \t\tflag = response.flag\n\t\t  \t\tconsole.log(response.flag)\n\t\t\t\tif (flag == false) {\n\t\t\t\t\tthis.currentpercentage -= 1\n\t\t\t\t}\n\t\t  \t})\t\t\n\t\t  }\n\t\t  if (this.currentpercentage === 100) {\n\t\t    //clearInterval(interval)\n\t\t\tthis.paramForm2.num = 0//进度条模拟\n\t\t\tthis.k = this.k + 1\n\t\t    this.currentstatus = 'success'\n\t\t\tthis.btnMsg = 'Running'\n\t\t\tthis.isTraining = false\n\t\t\tthis.currentpercentage = 0\n\t\t    //this.setprocess(3)\n\t\t\tgetResult().then(response => {\n\t\t\t\tconst { data } = response\n\t\t\t\tconsole.log(data)\n\t\t\t\tif(data.flag)\n\t\t\t\t{\n\t\t\t\t\tconsole.log(data.accu.length)\n\t\t\t\t\tthis.loss=data.loss\n\t\t\t\t\tthis.accu=data.accu\n\t\t\t\t}\n\t\t\t\t}).catch(function(error){\n\t\t\t\t\tconsole.log(error);\n\t\t\t\t})\n\t\t\tfor (var i = 0;i < this.clientNum;i++){\n\t\t\t\t//console.log(i)\n\t\t\t\tif (this.state[i] !== '待选用') {\n\t\t\t\t\tthis.state[i] = '第'+this.k+'轮训练中...'\n\t\t\t\t}\n\t\t\t}\n\t\t\t}\t\n\t\t}, this.traintime * 1000 / 1000)\n\t\t//this.currentpercentage = 0\n\t\tconsole.log(k)\t\n      },\n      startMining() {\n        setTimeout(() => {\n          this.$notify({\n            title: 'Message',\n            message: 'Mine Finished!',\n            type: 'success'\n          })\n          this.btnMsg = 'Run'\n          this.isTraining = false\n          this.state = 'synchronizing...'\n          this.setprocess(4)\n          setTimeout(() => {\n            this.state = 'finish'\n            this.blockheight += 1\n            this.updatetime = this.getcurrenttime()\n            this.$notify({\n              title: 'Message',\n              message: 'Synchronize Finished!',\n              type: 'success'\n            })\n          }, 5000)\n        }, 10000)\n      }\n    }\n  }\n</script>\n\n<style scoped>\n  .menu {\n    margin-top: 12px;\n    display: flex;\n    justify-content: space-between;\n    align-items: center\n  }\n\n</style>\n"]}]}