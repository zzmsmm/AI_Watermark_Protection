# Nlp水印算法总结：
## 白盒nlp：
### 算法介绍
对于白盒形式下，总体的算法流程与其他数据类型的白盒算法基本一致，对于一个模型训练的同时构建一个非公开的验证模块，对于nlp模型训练，我们通常会对于模型的输入（以情感分析为例，即为一句话）进行转换，例如构建词向量并将输入语句转换成固定格式的输入向量或者矩阵，所以我们根据为用户分配的特殊hash值构建一组随机向量（与模型的输入格式一致）作为后门，在对于模型使用正常数据训练后，进一步对于后门数据做前向传播，同时使用模型各层的输出进行拼接构建得到验证模块的输入来对于验证模块进行训练，最终用户将验证模块取hash值上传至服务端。
对于验证请求，用户上传相关的怀疑模型以及验证模块和后门数据，在与服务器数据库hash值匹配后，检测后门集准确率，进而判断是否是模型训练者本人。由于验证模块并不公开，这种方式能够有效的防止对于验证模块的直接攻击。
（缺点：对于微调操作抵抗性不是非常好）

### 使用流程
* 用户构建验证模块，正常训练模型。
* 训练完成后根据后门数据以及模型训练验证模块使得后门数据准确度达到标准，提交验证模块hash以及部分后门数据作为标识。
* 当用户遇到疑似侵权行为并能获取到对方的白盒权限时，用户需要将疑似侵权模型整理成可以直接与 Verify 模型对接的格式，并将整理好的模型及其类定义文件、版权认证时用到的水印数据上传到网站中，由网站执行前向传播，计算水印数据的分类精度。网站会对用户提交的水印数据计算散列值并和数据库中的记录进行对比，只有当两个散列值一致时，网站才会为用户执行裁决
* 网站将具备公信力的裁决结果提供给用户下载，该结果并不具备法律效力。

## 黑盒nlp总结
### 算法介绍
对于黑盒形式，我们进行了对于相关攻击具有鲁棒性的后门数据，我们根据整个训练集为依据，对于词语的重要性进行排序，并对于不同标签的部分数据根据排序交换其中部分词语构建出后门，交换的方式有多种选择：重要性最低或最高。最终将构造出来的后门数据与正常的训练数据共同进行训练得到最终的模型。
根据实验结果，对于后门数据的加入，模型原本的准确率几乎无影响，同时这种后门对于剪枝以及微调的鲁棒性很好，完全可以胜任后门的要求。
（缺点：没有找到一种能够明确的表明身份信息的后门构建方式，这种后门理论上是对于数据库单一的，但是对于不同数据库构建的后门最终的表现是否具有互斥性也难以证明。其实可以依据服务端维护的水印时间信息来进行判断，但是不够严谨）

### 使用流程
* 用户根据数据集构建后门数据。
* 将后门数据与原数据集共同作为训练集训练模型。并使得后门数据的准确度达到规定要求，最终上传后门数据。
* 当用户遇到疑似侵权行为用户需要将相关的黑盒模型api调用方式自行整理使得能够调用，并且上传网站，网站对于后门数据进行准确率测试，并根据结果表现做出判断。
* 网站将具备公信力的裁决结果提供给用户下载，该结果并不具备法律效力。
